<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="al:android:url" content="openapp://com.example.hibank">
	<meta property="al:android:url" content="openapp://com.istuat.hibank">
	<meta property="al:android:url" content="openapp://com.hibank.mobile">
    <meta property="al:ios:url" content="openapp://com.ist.hibank">
	<meta property="al:ios:url" content="openapp://com.ist-uat.hibank">
	<meta property="al:ios:url" content="openapp://com.hibank.mobile">
    <title>My Website Open App Test</title>
    <script>
		const playStore = 'https://play.google.com/store/apps/details?id=com.hibank.mobile';
		const appStore = 'https://apps.apple.com/id/app/hi-by-hibank/id6474590911?l=id';

	    // function openDeepLink() {
		// 	var endpoint = getQueryParamName('name')
		//     // var deepLink = "openapp://com.example.hibank/?name="+ endpoint;
		// 	var deepLink = "https://hibank.co.id/?name="+ endpoint;
		// 	console.log("openDeepLink::endpoint ==>", endpoint);
		// 	console.log("openDeepLink::deepLink ==>", deepLink);

	    //     setTimeout(function () {
	    //         const userOs = getMobileOS();
	    //         if (userOs == "Apple") {
	    //             window.location.href(appStore);
	    //         } else {
	    //             window.location.href(playStore);
	    //         }
	    //     }, 1000);

	    //     window.location.href(deepLink);
	    // }
		function openDeepLink() {
			var endpoint = getQueryParamName('name');
			var deepLink = "openapp://com.hibank.mobile/home?name=" + endpoint;

			var now = new Date().getTime();
			setTimeout(function () {
				var elapsed = new Date().getTime() - now;
				if (elapsed < 2000) {
				const os = getMobileOS();
				if (os === 'Apple') {
					window.location.href = appStore;
				} else {
					window.location.href = playStore;
				}
				}
			}, 1500);

			window.location.href = deepLink;
		}

		const getMobileOS = () => {
		 	var userAgent = window.navigator.userAgent,
		     	platform = window.navigator.platform,
		     	macosPlatforms = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'],
		      	windowsPlatforms = ['Win32', 'Win64', 'Windows', 'WinCE'],
		      	iosPlatforms = ['iPhone', 'iPad', 'iPod'],
		      	os = "Other";

			if (macosPlatforms.indexOf(platform) !== -1) {
				os = 'Apple';
			} else if (iosPlatforms.indexOf(platform) !== -1) {
			    os = 'Apple';
			} else if (windowsPlatforms.indexOf(platform) !== -1) {
			    os = 'Windows';
			} else if (/Android/.test(userAgent)) {
			    os = 'Android';
			} else if (!os && /Linux/.test(platform)) {
			    os = 'Linux';
			}

		 	return os;
		}

		// Mendapatkan query parameter dari URL
		function getQueryParamName(name) {
			const queryString = window.location.search;
			const urlParams = new URLSearchParams(queryString);
			return urlParams.get(name);
		}

	    // openDeepLink();
	</script>

</head>
<body>
    <h1>Welcome to My Website!</h1>
	  <p>Click the button below to see a greeting message.</p>
	  <button onclick="openDeepLink()">Click Me</button>

</body>
</html>